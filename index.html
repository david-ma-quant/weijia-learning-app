<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weijia's Learning Space ğŸŒ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Nunito', -apple-system, BlinkMacSystemFont, sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-gradient { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
        .pink-gradient { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .blue-gradient { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .green-gradient { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .orange-gradient { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
        .purple-gradient { background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); }
        .teal-gradient { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
        .bounce-in { animation: bounceIn 0.5s ease-out; }
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .current-week { border: 3px solid #f59e0b; box-shadow: 0 0 20px rgba(245, 158, 11, 0.3); }
        .tab-active { background: white; color: #7c3aed; }
        .homework-card { border-left: 4px solid #8b5cf6; }
        .cn-text { font-size: 0.85em; color: #6b7280; margin-top: 2px; }
        .vocab-card { border-left: 4px solid #10b981; }
        .scenario-btn { transition: all 0.2s; }
        .scenario-btn:hover { transform: scale(1.02); }
        .copy-btn { transition: all 0.2s; }
        .copy-btn:hover { background: #4f46e5; }
    </style>
</head>
<body class="min-h-screen gradient-bg">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <header class="text-center mb-8 bounce-in">
            <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-2">
                ğŸŒ¸ Weijia's Learning Space ğŸŒ¸
            </h1>
            <p class="text-white/90 text-lg">å”¯å˜‰çš„å­¦ä¹ ç©ºé—´</p>
            <p class="text-white/80 text-base mt-2">A little progress each day ğŸŒ±</p>
            <p class="text-white/60 text-sm">æ¯å¤©è¿›æ­¥ä¸€ç‚¹ç‚¹</p>
        </header>

        <!-- Navigation Tabs -->
        <div class="flex justify-center mb-6 overflow-x-auto">
            <div class="bg-white/20 backdrop-blur rounded-full p-1 flex gap-1">
                <button onclick="showTab('main')" id="tab-main" class="px-3 py-2 rounded-full font-bold transition-all tab-active text-sm">
                    ğŸ“Š Home
                </button>
                <button onclick="showTab('english')" id="tab-english" class="px-3 py-2 rounded-full font-bold transition-all text-white hover:bg-white/20 text-sm">
                    ğŸ”¤ English
                </button>
                <button onclick="showTab('homework')" id="tab-homework" class="px-3 py-2 rounded-full font-bold transition-all text-white hover:bg-white/20 text-sm">
                    ğŸ“š Homework
                </button>
                <button onclick="showTab('review')" id="tab-review" class="px-3 py-2 rounded-full font-bold transition-all text-white hover:bg-white/20 text-sm">
                    ğŸ“– Review
                </button>
            </div>
        </div>

        <!-- Main Tab -->
        <div id="content-main">
            <!-- Progress Dashboard -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl bounce-in">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ“Š My Progress</h2>
                <p class="text-gray-500 text-sm mb-4">æˆ‘çš„è¿›åº¦</p>
                <div class="grid grid-cols-4 gap-3 text-center">
                    <div class="pink-gradient rounded-2xl p-3 text-white">
                        <div class="text-2xl font-bold" id="streak">0</div>
                        <div class="text-xs opacity-90">ğŸ”¥ Streak</div>
                        <div class="text-xs opacity-70">è¿ç»­å¤©æ•°</div>
                    </div>
                    <div class="blue-gradient rounded-2xl p-3 text-white">
                        <div class="text-2xl font-bold" id="challenges">0</div>
                        <div class="text-xs opacity-90">âœ… Challenges</div>
                        <div class="text-xs opacity-70">æŒ‘æˆ˜</div>
                    </div>
                    <div class="green-gradient rounded-2xl p-3 text-white">
                        <div class="text-2xl font-bold" id="homeworkCount">0</div>
                        <div class="text-xs opacity-90">ğŸ“ Homework</div>
                        <div class="text-xs opacity-70">ä½œä¸š</div>
                    </div>
                    <div class="teal-gradient rounded-2xl p-3 text-white">
                        <div class="text-2xl font-bold" id="vocabCount">0</div>
                        <div class="text-xs opacity-90">ğŸ“š Words</div>
                        <div class="text-xs opacity-70">å•è¯</div>
                    </div>
                </div>
            </div>

            <!-- Weekly AI Challenges -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ¯ Weekly English AI Challenge</h2>
                <p class="text-gray-500 text-sm mb-4">æ¯å‘¨è‹±æ–‡ AI æŒ‘æˆ˜</p>
                <p class="text-gray-400 mb-4 text-sm">Chat with AI in English, check when done âœ“<br><span class="cn-text">ç”¨è‹±æ–‡å’Œ AI å¯¹è¯ï¼Œå®Œæˆåæ‰“å‹¾</span></p>
                <div class="space-y-3" id="challengeList">
                    <!-- Challenges will be inserted here -->
                </div>
            </div>

            <!-- Question of the Day -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ’¡ Question of the Day</h2>
                <p class="text-gray-500 text-sm mb-4">ä»Šæ—¥å¥½é—®é¢˜</p>
                <p class="text-gray-400 mb-3 text-sm">Good questions are more important than good answers!<br><span class="cn-text">å¥½é—®é¢˜æ¯”å¥½ç­”æ¡ˆæ›´é‡è¦ï¼</span></p>
                <div class="bg-purple-50 rounded-xl p-4 mb-4">
                    <p class="text-purple-700 font-semibold mb-2">ğŸ’­ Example Good Questions / å¥½é—®é¢˜ç¤ºä¾‹ï¼š</p>
                    <ul class="text-purple-600 text-sm space-y-2">
                        <li>â€¢ Why is the sky blue?<br><span class="cn-text">ä¸ºä»€ä¹ˆå¤©ç©ºæ˜¯è“è‰²çš„ï¼Ÿ</span></li>
                        <li>â€¢ What if the Earth stopped spinning?<br><span class="cn-text">å¦‚æœåœ°çƒåœæ­¢è½¬åŠ¨ä¼šæ€æ ·ï¼Ÿ</span></li>
                        <li>â€¢ How can I make AI draw better pictures?<br><span class="cn-text">æ€ä¹ˆæ‰èƒ½è®© AI ç”»å‡ºæ›´å¥½çœ‹çš„å›¾ï¼Ÿ</span></li>
                    </ul>
                </div>
                <textarea 
                    id="dailyQuestion" 
                    class="w-full p-4 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none resize-none"
                    rows="3"
                    placeholder="Write your question here... å†™ä¸‹ä½ çš„é—®é¢˜..."></textarea>
                <button onclick="saveQuestion()" class="mt-3 w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200 transform hover:scale-[1.02]">
                    Save Question ğŸ’¾<span class="text-sm ml-2 opacity-80">ä¿å­˜é—®é¢˜</span>
                </button>
                <div id="questionHistory" class="mt-4 space-y-2"></div>
            </div>

            <!-- Teach Back Section -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ‘©â€ğŸ« Mini Teacher Time</h2>
                <p class="text-gray-500 text-sm mb-4">å°è€å¸ˆæ—¶é—´</p>
                <p class="text-gray-400 mb-4 text-sm">Explain what you learned in your own words â€” this is the best way to learn!<br><span class="cn-text">ç”¨ä½ è‡ªå·±çš„è¯è§£é‡Šå­¦åˆ°çš„å†…å®¹ - è¿™æ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹å¼ï¼</span></p>
                <div class="bg-orange-50 rounded-xl p-4 mb-4">
                    <p class="text-orange-700">ğŸ¬ Record a 2-minute video teaching what you learned today!<br><span class="cn-text">å½•ä¸€æ®µ 2 åˆ†é’Ÿçš„è§†é¢‘ï¼Œæ•™åˆ«äººä½ ä»Šå¤©å­¦åˆ°çš„ä¸œè¥¿ï¼</span></p>
                </div>
                <textarea 
                    id="teachBack" 
                    class="w-full p-4 border-2 border-orange-200 rounded-xl focus:border-orange-400 focus:outline-none resize-none"
                    rows="4"
                    placeholder="Today I learned... I would explain it like this... ä»Šå¤©æˆ‘å­¦åˆ°äº†...æˆ‘æƒ³è¿™æ ·è§£é‡Š..."></textarea>
                <button onclick="saveTeachBack()" class="mt-3 w-full bg-orange-400 hover:bg-orange-500 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200 transform hover:scale-[1.02]">
                    Save Notes ğŸ“<span class="text-sm ml-2 opacity-80">ä¿å­˜ç¬”è®°</span>
                </button>
            </div>

            <!-- AI Tools Recommendations (China-accessible) -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ› ï¸ AI Tools</h2>
                <p class="text-gray-500 text-sm mb-4">AI å·¥å…·æ¨èï¼ˆå›½å†…å¯ç”¨ï¼‰</p>
                <p class="text-gray-400 mb-4 text-sm">â­ = Beginner å…¥é—¨ ï½œ â­â­ = Intermediate è¿›é˜¶</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <a href="https://chat.deepseek.com" target="_blank" class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 card-hover transition-all duration-300 cursor-pointer border border-blue-100 block no-underline">
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-blue-700">ğŸ”® DeepSeek</span>
                            <span class="text-yellow-500">â­</span>
                        </div>
                        <p class="text-blue-600 text-sm mt-1">Powerful AI assistant, free to use</p>
                        <p class="cn-text">å¼ºå¤§çš„ AI å¯¹è¯åŠ©æ‰‹ï¼Œå…è´¹å¥½ç”¨</p>
                    </a>
                    <a href="https://www.doubao.com" target="_blank" class="bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl p-4 card-hover transition-all duration-300 cursor-pointer border border-orange-100 block no-underline">
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-orange-700">ğŸ«› Doubao (è±†åŒ…)</span>
                            <span class="text-yellow-500">â­</span>
                        </div>
                        <p class="text-orange-600 text-sm mt-1">Great for chatting and writing</p>
                        <p class="cn-text">å­—èŠ‚è·³åŠ¨å‡ºå“ï¼ŒèŠå¤©å†™ä½œéƒ½å¾ˆæ£’</p>
                    </a>
                    <a href="https://kimi.moonshot.cn" target="_blank" class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 card-hover transition-all duration-300 cursor-pointer border border-purple-100 block no-underline">
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-purple-700">ğŸŒ™ Kimi</span>
                            <span class="text-yellow-500">â­</span>
                        </div>
                        <p class="text-purple-600 text-sm mt-1">Amazing at reading long articles</p>
                        <p class="cn-text">è¶…é•¿æ–‡æœ¬å¤„ç†ï¼Œè¯»æ–‡ç« è¶…å‰å®³</p>
                    </a>
                    <a href="https://yiyan.baidu.com" target="_blank" class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 card-hover transition-all duration-300 cursor-pointer border border-green-100 block no-underline">
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-green-700">ğŸ’¬ ERNIE Bot (æ–‡å¿ƒä¸€è¨€)</span>
                            <span class="text-yellow-500">â­</span>
                        </div>
                        <p class="text-green-600 text-sm mt-1">Strong Chinese understanding</p>
                        <p class="cn-text">ç™¾åº¦å‡ºå“ï¼Œä¸­æ–‡ç†è§£å¾ˆå¼º</p>
                    </a>
                    <a href="https://tongyi.aliyun.com" target="_blank" class="bg-gradient-to-r from-red-50 to-orange-50 rounded-xl p-4 card-hover transition-all duration-300 cursor-pointer border border-red-100 block no-underline">
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-red-700">ğŸ§  Tongyi Qianwen (é€šä¹‰åƒé—®)</span>
                            <span class="text-yellow-500">â­</span>
                        </div>
                        <p class="text-red-600 text-sm mt-1">Full-featured AI by Alibaba</p>
                        <p class="cn-text">é˜¿é‡Œå‡ºå“ï¼ŒåŠŸèƒ½å…¨é¢</p>
                    </a>
                    <a href="https://www.tiangong.cn" target="_blank" class="bg-gradient-to-r from-cyan-50 to-blue-50 rounded-xl p-4 card-hover transition-all duration-300 cursor-pointer border border-cyan-100 block no-underline">
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-cyan-700">ğŸ¨ Tiangong AI (å¤©å·¥)</span>
                            <span class="text-yellow-500">â­â­</span>
                        </div>
                        <p class="text-cyan-600 text-sm mt-1">Can draw and create</p>
                        <p class="cn-text">å¯ä»¥ç”»ç”»å’Œåˆ›ä½œ</p>
                    </a>
                </div>
            </div>
        </div>

        <!-- English 1v1 Tab (NEW) -->
        <div id="content-english" class="hidden">
            <!-- Vocabulary Book -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-green-600 mb-1">ğŸ“š Vocabulary Book</h2>
                <p class="text-gray-500 text-sm mb-4">è¯¾åè¯æ±‡æœ¬</p>
                <p class="text-gray-400 mb-4 text-sm">Record 5-10 new words after each English class!<br><span class="cn-text">æ¯èŠ‚è‹±è¯­è¯¾åè®°å½• 5-10 ä¸ªæ–°è¯ï¼</span></p>
                
                <!-- Add new word -->
                <div class="bg-green-50 rounded-xl p-4 mb-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-3">
                        <input type="text" id="newWord" placeholder="English word / è‹±æ–‡å•è¯" 
                            class="p-3 border-2 border-green-200 rounded-xl focus:border-green-400 focus:outline-none">
                        <input type="text" id="wordMeaning" placeholder="Chinese meaning / ä¸­æ–‡æ„æ€" 
                            class="p-3 border-2 border-green-200 rounded-xl focus:border-green-400 focus:outline-none">
                    </div>
                    <input type="text" id="wordExample" placeholder="Example sentence (optional) / ä¾‹å¥ï¼ˆå¯é€‰ï¼‰" 
                        class="w-full p-3 border-2 border-green-200 rounded-xl focus:border-green-400 focus:outline-none mb-3">
                    <button onclick="addVocab()" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl transition-all">
                        Add Word â•<span class="text-sm ml-2 opacity-80">æ·»åŠ å•è¯</span>
                    </button>
                </div>

                <!-- AI Sentence Generator -->
                <div class="bg-blue-50 rounded-xl p-4 mb-4">
                    <p class="text-blue-700 font-semibold mb-2">ğŸ¤– AI Sentence Helper / AI é€ å¥åŠ©æ‰‹</p>
                    <p class="text-blue-600 text-sm mb-3">Click to copy prompt, then paste to AI for example sentences!<br><span class="cn-text">ç‚¹å‡»å¤åˆ¶æç¤ºè¯ï¼Œç²˜è´´ç»™ AI ç”Ÿæˆä¾‹å¥ï¼</span></p>
                    <button onclick="copyVocabPrompt()" class="copy-btn bg-blue-500 text-white font-bold py-2 px-4 rounded-lg text-sm">
                        ğŸ“‹ Copy Prompt å¤åˆ¶æç¤ºè¯
                    </button>
                </div>

                <!-- Vocab list -->
                <div id="vocabList" class="space-y-3">
                    <p class="text-gray-400 text-center py-4">No words yet. Add your first word! ğŸ“–<br><span class="cn-text">è¿˜æ²¡æœ‰å•è¯ï¼Œæ·»åŠ ä½ çš„ç¬¬ä¸€ä¸ªå•è¯å§ï¼</span></p>
                </div>

                <!-- Review reminder -->
                <div class="mt-4 bg-amber-50 rounded-xl p-4">
                    <p class="text-amber-700 font-semibold">â° Review Reminder / å¤ä¹ æé†’</p>
                    <p class="text-amber-600 text-sm mt-1">Words to review today: <span id="reviewCount" class="font-bold">0</span><br><span class="cn-text">ä»Šæ—¥éœ€å¤ä¹ å•è¯æ•°</span></p>
                    <button onclick="startVocabReview()" class="mt-2 bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all">
                        ğŸ¯ Start Review å¼€å§‹å¤ä¹ 
                    </button>
                </div>
            </div>

            <!-- AI Conversation Practice -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ’¬ AI Conversation Practice</h2>
                <p class="text-gray-500 text-sm mb-4">AI å¯¹è¯ç»ƒä¹ </p>
                <p class="text-gray-400 mb-4 text-sm">Practice English conversations with AI! Choose a scenario below.<br><span class="cn-text">å’Œ AI ç»ƒä¹ è‹±è¯­å¯¹è¯ï¼é€‰æ‹©ä¸‹é¢çš„åœºæ™¯ã€‚</span></p>

                <!-- Scenario buttons -->
                <div class="grid grid-cols-2 md:grid-cols-3 gap-3 mb-4">
                    <button onclick="loadScenario('restaurant')" class="scenario-btn bg-gradient-to-r from-red-100 to-orange-100 rounded-xl p-4 text-left border border-red-200">
                        <div class="text-2xl mb-1">ğŸ•</div>
                        <div class="font-bold text-red-700 text-sm">Restaurant</div>
                        <div class="text-xs text-red-600">ç‚¹é¤</div>
                    </button>
                    <button onclick="loadScenario('shopping')" class="scenario-btn bg-gradient-to-r from-pink-100 to-purple-100 rounded-xl p-4 text-left border border-pink-200">
                        <div class="text-2xl mb-1">ğŸ›ï¸</div>
                        <div class="font-bold text-pink-700 text-sm">Shopping</div>
                        <div class="text-xs text-pink-600">è´­ç‰©</div>
                    </button>
                    <button onclick="loadScenario('directions')" class="scenario-btn bg-gradient-to-r from-blue-100 to-cyan-100 rounded-xl p-4 text-left border border-blue-200">
                        <div class="text-2xl mb-1">ğŸ—ºï¸</div>
                        <div class="font-bold text-blue-700 text-sm">Directions</div>
                        <div class="text-xs text-blue-600">é—®è·¯</div>
                    </button>
                    <button onclick="loadScenario('school')" class="scenario-btn bg-gradient-to-r from-green-100 to-teal-100 rounded-xl p-4 text-left border border-green-200">
                        <div class="text-2xl mb-1">ğŸ«</div>
                        <div class="font-bold text-green-700 text-sm">School Life</div>
                        <div class="text-xs text-green-600">æ ¡å›­ç”Ÿæ´»</div>
                    </button>
                    <button onclick="loadScenario('travel')" class="scenario-btn bg-gradient-to-r from-indigo-100 to-purple-100 rounded-xl p-4 text-left border border-indigo-200">
                        <div class="text-2xl mb-1">âœˆï¸</div>
                        <div class="font-bold text-indigo-700 text-sm">Travel</div>
                        <div class="text-xs text-indigo-600">æ—…è¡Œ</div>
                    </button>
                    <button onclick="loadScenario('making_friends')" class="scenario-btn bg-gradient-to-r from-yellow-100 to-amber-100 rounded-xl p-4 text-left border border-yellow-200">
                        <div class="text-2xl mb-1">ğŸ‘‹</div>
                        <div class="font-bold text-yellow-700 text-sm">Making Friends</div>
                        <div class="text-xs text-yellow-600">äº¤æœ‹å‹</div>
                    </button>
                </div>

                <!-- Selected scenario prompt -->
                <div id="scenarioPrompt" class="bg-purple-50 rounded-xl p-4 mb-4 hidden">
                    <p class="text-purple-700 font-semibold mb-2">ğŸ“ Conversation Prompt / å¯¹è¯æç¤ºè¯</p>
                    <p id="scenarioText" class="text-purple-600 text-sm mb-3 whitespace-pre-line"></p>
                    <div class="flex gap-2">
                        <button onclick="copyScenarioPrompt()" class="copy-btn bg-purple-500 text-white font-bold py-2 px-4 rounded-lg text-sm flex-1">
                            ğŸ“‹ Copy å¤åˆ¶
                        </button>
                        <a href="https://www.doubao.com" target="_blank" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg text-sm text-center flex-1">
                            ğŸ«› Open Doubao
                        </a>
                    </div>
                </div>

                <!-- Tips -->
                <div class="bg-green-50 rounded-xl p-4">
                    <p class="text-green-700 font-semibold mb-2">ğŸ’¡ Tips / ç»ƒä¹ æŠ€å·§</p>
                    <ul class="text-green-600 text-sm space-y-1">
                        <li>â€¢ Try to reply in full sentences å°½é‡ç”¨å®Œæ•´å¥å­å›å¤</li>
                        <li>â€¢ If stuck, ask AI: "How do I say... in English?" ä¸ä¼šè¯´å°±é—® AI</li>
                        <li>â€¢ Don't be afraid of mistakes! AI will help you ä¸æ€•è¯´é”™ï¼AI ä¼šå¸®ä½ </li>
                    </ul>
                </div>
            </div>

            <!-- Class Recording Summary -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-blue-600 mb-1">ğŸ™ï¸ Class Recording Summary</h2>
                <p class="text-gray-500 text-sm mb-4">è¯¾å ‚å½•éŸ³æ€»ç»“</p>
                <p class="text-gray-400 mb-4 text-sm">Upload your class recording and let AI summarize the key points!<br><span class="cn-text">ä¸Šä¼ è¯¾å ‚å½•éŸ³ï¼Œè®© AI å¸®ä½ æ€»ç»“é‡ç‚¹ï¼</span></p>

                <!-- Recording upload area -->
                <div class="bg-blue-50 rounded-xl p-6 mb-4 text-center border-2 border-dashed border-blue-300">
                    <div class="text-4xl mb-2">ğŸ¤</div>
                    <p class="text-blue-700 font-semibold">How to use / ä½¿ç”¨æ–¹æ³•ï¼š</p>
                    <ol class="text-blue-600 text-sm mt-2 text-left list-decimal list-inside space-y-2">
                        <li>Record your 1v1 class (ask teacher's permission first!)<br><span class="cn-text">å½•åˆ¶ç½‘è¯¾ï¼ˆå…ˆé—®è€å¸ˆæ˜¯å¦å…è®¸ï¼ï¼‰</span></li>
                        <li>Open Kimi (supports audio upload)<br><span class="cn-text">æ‰“å¼€ Kimiï¼ˆæ”¯æŒä¸Šä¼ éŸ³é¢‘ï¼‰</span></li>
                        <li>Upload the recording and paste the prompt below<br><span class="cn-text">ä¸Šä¼ å½•éŸ³ï¼Œç²˜è´´ä¸‹é¢çš„æç¤ºè¯</span></li>
                    </ol>
                </div>

                <!-- Prompt for class summary -->
                <div class="bg-indigo-50 rounded-xl p-4 mb-4">
                    <p class="text-indigo-700 font-semibold mb-2">ğŸ“ Summary Prompt / æ€»ç»“æç¤ºè¯</p>
                    <p id="summaryPromptText" class="text-indigo-600 text-sm mb-3 bg-white p-3 rounded-lg">Please listen to this English class recording and help me:
1. List all new vocabulary words with meanings
2. Summarize the main grammar points
3. Note any pronunciation corrections the teacher made
4. List useful phrases or expressions
5. Suggest 3 things I should practice

è¯·å¬è¿™æ®µè‹±è¯­è¯¾å½•éŸ³ï¼Œå¸®æˆ‘ï¼š
1. åˆ—å‡ºæ‰€æœ‰ç”Ÿè¯å’Œæ„æ€
2. æ€»ç»“ä¸»è¦è¯­æ³•ç‚¹
3. è®°å½•è€å¸ˆçº æ­£çš„å‘éŸ³
4. åˆ—å‡ºæœ‰ç”¨çš„çŸ­è¯­è¡¨è¾¾
5. å»ºè®®3ä¸ªéœ€è¦ç»ƒä¹ çš„åœ°æ–¹</p>
                    <div class="flex gap-2">
                        <button onclick="copySummaryPrompt()" class="copy-btn bg-indigo-500 text-white font-bold py-2 px-4 rounded-lg text-sm flex-1">
                            ğŸ“‹ Copy Prompt å¤åˆ¶æç¤ºè¯
                        </button>
                        <a href="https://kimi.moonshot.cn" target="_blank" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg text-sm text-center flex-1">
                            ğŸŒ™ Open Kimi
                        </a>
                    </div>
                </div>

                <!-- Saved summaries -->
                <div class="mb-4">
                    <p class="text-gray-600 font-semibold mb-2">ğŸ“‹ Save Your Summary / ä¿å­˜æ€»ç»“</p>
                    <textarea id="classSummary" class="w-full p-4 border-2 border-blue-200 rounded-xl focus:border-blue-400 focus:outline-none resize-none" rows="4" placeholder="Paste your AI-generated summary here... æŠŠ AI ç”Ÿæˆçš„æ€»ç»“ç²˜è´´åˆ°è¿™é‡Œ..."></textarea>
                    <button onclick="saveClassSummary()" class="mt-2 w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-xl transition-all">
                        Save Summary ğŸ’¾<span class="text-sm ml-2 opacity-80">ä¿å­˜æ€»ç»“</span>
                    </button>
                </div>

                <!-- Saved summaries list -->
                <div id="summaryList" class="space-y-3">
                </div>
            </div>
        </div>

        <!-- Homework Tab -->
        <div id="content-homework" class="hidden">
            <!-- Add Homework -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ“ Add New Homework</h2>
                <p class="text-gray-500 text-sm mb-4">æ·»åŠ æ–°ä½œä¸š</p>
                <div class="space-y-4">
                    <div>
                        <label class="block text-gray-600 mb-2 font-semibold">Subject / ç§‘ç›®</label>
                        <select id="hwSubject" class="w-full p-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                            <option value="Chinese è¯­æ–‡">ğŸ“– Chinese è¯­æ–‡</option>
                            <option value="Math æ•°å­¦">ğŸ”¢ Math æ•°å­¦</option>
                            <option value="English è‹±è¯­">ğŸ”¤ English è‹±è¯­</option>
                            <option value="Physics ç‰©ç†">âš¡ Physics ç‰©ç†</option>
                            <option value="Chemistry åŒ–å­¦">ğŸ§ª Chemistry åŒ–å­¦</option>
                            <option value="Biology ç”Ÿç‰©">ğŸŒ¿ Biology ç”Ÿç‰©</option>
                            <option value="History å†å²">ğŸ“œ History å†å²</option>
                            <option value="Geography åœ°ç†">ğŸŒ Geography åœ°ç†</option>
                            <option value="Politics æ”¿æ²»">ğŸ“‹ Politics æ”¿æ²»</option>
                            <option value="Other å…¶ä»–">ğŸ“Œ Other å…¶ä»–</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-600 mb-2 font-semibold">Homework Content / ä½œä¸šå†…å®¹</label>
                        <textarea 
                            id="hwContent" 
                            class="w-full p-4 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none resize-none"
                            rows="3"
                            placeholder="Describe the homework... æè¿°ä½œä¸šå†…å®¹..."></textarea>
                    </div>
                    <div>
                        <label class="block text-gray-600 mb-2 font-semibold">Due Date / æˆªæ­¢æ—¥æœŸ</label>
                        <input type="date" id="hwDueDate" class="w-full p-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                    </div>
                    <button onclick="addHomework()" class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200 transform hover:scale-[1.02]">
                        Add Homework â•<span class="text-sm ml-2 opacity-80">æ·»åŠ ä½œä¸š</span>
                    </button>
                </div>
            </div>

            <!-- Pending Homework -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ“‹ Pending Homework</h2>
                <p class="text-gray-500 text-sm mb-4">å¾…å®Œæˆä½œä¸š</p>
                <div id="pendingHomework" class="space-y-3">
                    <p class="text-gray-400 text-center py-8">No pending homework âœ¨<br><span class="cn-text">æš‚æ— å¾…å®Œæˆä½œä¸š</span></p>
                </div>
            </div>

            <!-- AI Homework Helper -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ¤– AI Homework Helper</h2>
                <p class="text-gray-500 text-sm mb-4">AI ä½œä¸šåŠ©æ‰‹</p>
                <p class="text-gray-400 mb-4 text-sm">Stuck on a problem? Copy it to these AI tools for help!<br><span class="cn-text">é‡åˆ°ä¸ä¼šçš„é¢˜ç›®ï¼Ÿå¤åˆ¶åˆ° AI å·¥å…·å¯»æ±‚å¸®åŠ©ï¼</span></p>
                <div class="bg-blue-50 rounded-xl p-4 mb-4">
                    <p class="text-blue-700 font-semibold mb-2">ğŸ’¡ Tips / ä½¿ç”¨æŠ€å·§ï¼š</p>
                    <ul class="text-blue-600 text-sm space-y-2">
                        <li>â€¢ Think first, then ask AI<br><span class="cn-text">å…ˆè‡ªå·±æ€è€ƒï¼Œä¸ä¼šå†é—® AI</span></li>
                        <li>â€¢ Ask AI to explain the process, don't just copy answers<br><span class="cn-text">è®© AI è§£é‡Šæ€è·¯ï¼Œä¸è¦ç›´æ¥æŠ„ç­”æ¡ˆ</span></li>
                        <li>â€¢ Practice English by asking in English!<br><span class="cn-text">ç”¨è‹±æ–‡æé—®æ¥ç»ƒä¹ è‹±è¯­ï¼</span></li>
                    </ul>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <a href="https://chat.deepseek.com" target="_blank" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-xl text-center transition-all">
                        ğŸ”® Ask DeepSeek
                    </a>
                    <a href="https://www.doubao.com" target="_blank" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-4 rounded-xl text-center transition-all">
                        ğŸ«› Ask Doubao
                    </a>
                    <a href="https://kimi.moonshot.cn" target="_blank" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-4 rounded-xl text-center transition-all">
                        ğŸŒ™ Ask Kimi
                    </a>
                    <a href="https://yiyan.baidu.com" target="_blank" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-xl text-center transition-all">
                        ğŸ’¬ Ask ERNIE
                    </a>
                </div>
            </div>
        </div>

        <!-- Review Tab -->
        <div id="content-review" class="hidden">
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ“– Exam Review</h2>
                <p class="text-gray-500 text-sm mb-4">è€ƒè¯•å¤ä¹ </p>
                <p class="text-gray-400 mb-4">Select a subject to view past homework for review!<br><span class="cn-text">é€‰æ‹©ç§‘ç›®æŸ¥çœ‹å†å²ä½œä¸šï¼Œå¸®åŠ©ä½ å¤ä¹ ï¼</span></p>
                
                <div class="mb-4">
                    <label class="block text-gray-600 mb-2 font-semibold">Select Subject / é€‰æ‹©ç§‘ç›®</label>
                    <select id="reviewSubject" onchange="filterReview()" class="w-full p-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                        <option value="all">ğŸ“š All Subjects å…¨éƒ¨ç§‘ç›®</option>
                        <option value="Chinese è¯­æ–‡">ğŸ“– Chinese è¯­æ–‡</option>
                        <option value="Math æ•°å­¦">ğŸ”¢ Math æ•°å­¦</option>
                        <option value="English è‹±è¯­">ğŸ”¤ English è‹±è¯­</option>
                        <option value="Physics ç‰©ç†">âš¡ Physics ç‰©ç†</option>
                        <option value="Chemistry åŒ–å­¦">ğŸ§ª Chemistry åŒ–å­¦</option>
                        <option value="Biology ç”Ÿç‰©">ğŸŒ¿ Biology ç”Ÿç‰©</option>
                        <option value="History å†å²">ğŸ“œ History å†å²</option>
                        <option value="Geography åœ°ç†">ğŸŒ Geography åœ°ç†</option>
                        <option value="Politics æ”¿æ²»">ğŸ“‹ Politics æ”¿æ²»</option>
                    </select>
                </div>

                <div id="reviewList" class="space-y-3">
                    <p class="text-gray-400 text-center py-8">Complete homework to see history here ğŸ“<br><span class="cn-text">å®Œæˆä½œä¸šåè¿™é‡Œä¼šæ˜¾ç¤ºå†å²è®°å½•</span></p>
                </div>
            </div>

            <!-- AI Review Helper -->
            <div class="bg-white/95 backdrop-blur rounded-3xl p-6 mb-6 shadow-2xl">
                <h2 class="text-2xl font-bold text-purple-600 mb-1">ğŸ¯ AI Review Helper</h2>
                <p class="text-gray-500 text-sm mb-4">AI å¤ä¹ åŠ©æ‰‹</p>
                <div class="bg-green-50 rounded-xl p-4 mb-4">
                    <p class="text-green-700 font-semibold mb-2">ğŸ“ Review Tips / å¤ä¹ å»ºè®®ï¼š</p>
                    <ul class="text-green-600 text-sm space-y-2">
                        <li>â€¢ Copy homework to AI, ask it to create similar problems<br><span class="cn-text">æŠŠä½œä¸šå†…å®¹å¤åˆ¶ç»™ AIï¼Œè®©å®ƒå‡ºç±»ä¼¼çš„é¢˜ç›®</span></li>
                        <li>â€¢ Ask AI to summarize the key points<br><span class="cn-text">è®© AI æ€»ç»“è¿™ä¸ªç« èŠ‚çš„é‡ç‚¹</span></li>
                        <li>â€¢ Let AI be your teacher and quiz you!<br><span class="cn-text">è®© AI æ‰®æ¼”è€å¸ˆè€ƒä½ ï¼</span></li>
                    </ul>
                </div>
                <a href="https://chat.deepseek.com" target="_blank" class="block w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-4 px-6 rounded-xl text-center transition-all duration-200 transform hover:scale-[1.02]">
                    ğŸš€ Start AI Review<span class="text-sm ml-2 opacity-80">å¼€å§‹ AI å¤ä¹ </span>
                </a>
            </div>
        </div>

        <!-- Vocab Review Modal -->
        <div id="vocabReviewModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-3xl p-6 m-4 max-w-md w-full">
                <h3 class="text-xl font-bold text-green-600 mb-1">ğŸ¯ Vocabulary Review</h3>
                <p class="text-gray-500 text-sm mb-4">å•è¯å¤ä¹ </p>
                <div id="reviewCard" class="bg-green-50 rounded-xl p-6 text-center mb-4">
                    <p id="reviewWord" class="text-3xl font-bold text-green-700 mb-2">word</p>
                    <p id="reviewMeaning" class="text-gray-500 hidden">meaning</p>
                    <p id="reviewExample" class="text-sm text-gray-400 mt-2 hidden">example</p>
                </div>
                <div class="flex gap-3 mb-4">
                    <button onclick="showMeaning()" id="showMeaningBtn" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-xl">Show æ˜¾ç¤º</button>
                    <button onclick="nextReviewWord(false)" class="flex-1 bg-red-400 hover:bg-red-500 text-white font-bold py-2 px-4 rounded-xl">Again å†æ¥</button>
                    <button onclick="nextReviewWord(true)" class="flex-1 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-xl">Got it âœ“</button>
                </div>
                <p class="text-center text-gray-500 text-sm">Progress: <span id="reviewProgress">0/0</span></p>
                <button onclick="closeVocabReview()" class="mt-4 w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-xl">Close å…³é—­</button>
            </div>
        </div>

        <!-- Encouragement -->
        <div class="text-center py-6">
            <div class="inline-block bg-white/20 backdrop-blur rounded-2xl px-8 py-4">
                <p class="text-white text-xl font-bold">ğŸ’ª You can do it!</p>
                <p class="text-white/90 text-base">åŠ æ²¹ï¼ä½ å¯ä»¥çš„ï¼</p>
                <p class="text-white/80 text-sm mt-2">In the AI era, those who ask good questions are more valuable than those who have answers âœ¨</p>
                <p class="text-white/60 text-xs mt-1">åœ¨ AI æ—¶ä»£ï¼Œä¼šé—®é—®é¢˜çš„äººæ¯”ä¼šç­”é—®é¢˜çš„äººæ›´æœ‰ä»·å€¼</p>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center text-white/60 text-sm pb-8">
            Made with ğŸ’œ by Brother David / å“¥å“¥ David
        </footer>

        <!-- Settings Modal -->
        <div id="settingsModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-3xl p-6 m-4 max-w-md w-full">
                <h3 class="text-xl font-bold text-purple-600 mb-1">âš™ï¸ Notification Settings</h3>
                <p class="text-gray-500 text-sm mb-4">é€šçŸ¥è®¾ç½®</p>
                <p class="text-gray-400 text-sm mb-4">Set up Serveré…± Key to notify mom when tasks are done<br><span class="cn-text">è®¾ç½® Serveré…± Key åï¼Œå®Œæˆä»»åŠ¡ä¼šé€šçŸ¥å¦ˆå¦ˆ</span></p>
                <input type="text" id="serverChanKey" placeholder="Serveré…± SendKey" 
                    class="w-full p-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none mb-4">
                <div class="flex gap-3">
                    <button onclick="saveSettings()" class="flex-1 bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-xl">Save ä¿å­˜</button>
                    <button onclick="closeSettings()" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-xl">Cancel å–æ¶ˆ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Button -->
    <button onclick="openSettings()" class="fixed bottom-6 right-6 w-14 h-14 bg-white shadow-2xl rounded-full flex items-center justify-center text-2xl hover:scale-110 transition-all">
        âš™ï¸
    </button>

    <script>
        // Serveré…± Key for WeChat notifications
        let serverChanKey = localStorage.getItem('weijia_serverchan') || '';

        // Conversation scenarios
        const scenarios = {
            restaurant: `You are a friendly waiter at a restaurant. I am a customer. Let's practice ordering food in English. 

Start by greeting me and asking what I'd like to order. Keep responses short and natural. If I make grammar mistakes, gently correct me and show the right way to say it.

After each exchange, give me a "Useful phrase" I can learn.

ä½ æ˜¯é¤å…æœåŠ¡å‘˜ï¼Œæˆ‘æ˜¯é¡¾å®¢ã€‚æˆ‘ä»¬æ¥ç»ƒä¹ è‹±è¯­ç‚¹é¤å¯¹è¯ã€‚ç”¨ç®€çŸ­è‡ªç„¶çš„å›å¤ã€‚å¦‚æœæˆ‘è¯­æ³•é”™äº†ï¼Œæ¸©æŸ”åœ°çº æ­£æˆ‘ã€‚æ¯æ¬¡å¯¹è¯åç»™æˆ‘ä¸€ä¸ª"æœ‰ç”¨çŸ­è¯­"ã€‚`,

            shopping: `You are a helpful shop assistant. I am a customer looking to buy clothes/shoes. Let's practice shopping conversations in English.

Start by greeting me and asking how you can help. Keep responses short and natural. If I make mistakes, gently correct me.

After each exchange, give me a "Useful phrase" I can learn.

ä½ æ˜¯å•†åº—åº—å‘˜ï¼Œæˆ‘åœ¨ä¹°è¡£æœ/é‹å­ã€‚æˆ‘ä»¬æ¥ç»ƒä¹ è‹±è¯­è´­ç‰©å¯¹è¯ã€‚å¦‚æœæˆ‘è¯´é”™äº†ï¼Œæ¸©æŸ”åœ°çº æ­£æˆ‘ã€‚æ¯æ¬¡å¯¹è¯åç»™æˆ‘ä¸€ä¸ª"æœ‰ç”¨çŸ­è¯­"ã€‚`,

            directions: `You are a local person on the street. I am a tourist asking for directions. Let's practice asking and giving directions in English.

I'll ask you how to get to places like the train station, museum, or restaurant. Give me clear directions. If I make mistakes, gently correct me.

After each exchange, give me a "Useful phrase" I can learn.

ä½ æ˜¯å½“åœ°äººï¼Œæˆ‘æ˜¯æ¸¸å®¢é—®è·¯ã€‚æˆ‘ä»¬æ¥ç»ƒä¹ è‹±è¯­é—®è·¯å¯¹è¯ã€‚ç»™æˆ‘æ¸…æ¥šçš„æŒ‡è·¯è¯´æ˜ã€‚å¦‚æœæˆ‘è¯´é”™äº†ï¼Œæ¸©æŸ”åœ°çº æ­£æˆ‘ã€‚`,

            school: `You are my classmate at school. Let's have a casual conversation about school life in English - talking about classes, teachers, homework, hobbies, etc.

Keep it natural and fun! If I make mistakes, gently correct me.

After each exchange, give me a "Useful phrase" I can learn.

ä½ æ˜¯æˆ‘çš„åŒå­¦ã€‚æˆ‘ä»¬ç”¨è‹±è¯­èŠèŠå­¦æ ¡ç”Ÿæ´»â€”â€”è¯¾ç¨‹ã€è€å¸ˆã€ä½œä¸šã€çˆ±å¥½ç­‰ã€‚ä¿æŒè‡ªç„¶æœ‰è¶£ï¼å¦‚æœæˆ‘è¯´é”™äº†ï¼Œæ¸©æŸ”åœ°çº æ­£æˆ‘ã€‚`,

            travel: `You are a travel agent. I want to plan a trip. Let's practice travel-related conversations in English - booking flights, hotels, asking about attractions, etc.

Keep responses helpful and clear. If I make mistakes, gently correct me.

After each exchange, give me a "Useful phrase" I can learn.

ä½ æ˜¯æ—…è¡Œç¤¾å‘˜å·¥ã€‚æˆ‘æƒ³è®¡åˆ’ä¸€æ¬¡æ—…è¡Œã€‚æˆ‘ä»¬æ¥ç»ƒä¹ è‹±è¯­æ—…è¡Œå¯¹è¯â€”â€”è®¢æœºç¥¨ã€é…’åº—ã€é—®æ™¯ç‚¹ç­‰ã€‚å¦‚æœæˆ‘è¯´é”™äº†ï¼Œæ¸©æŸ”åœ°çº æ­£æˆ‘ã€‚`,

            making_friends: `You are a new student from America. I want to make friends with you. Let's have a friendly conversation in English - introducing ourselves, talking about hobbies, favorite music, sports, etc.

Be friendly and curious! If I make mistakes, gently correct me.

After each exchange, give me a "Useful phrase" I can learn.

ä½ æ˜¯æ¥è‡ªç¾å›½çš„æ–°åŒå­¦ã€‚æˆ‘æƒ³å’Œä½ äº¤æœ‹å‹ã€‚æˆ‘ä»¬ç”¨è‹±è¯­å‹å¥½åœ°èŠå¤©â€”â€”è‡ªæˆ‘ä»‹ç»ã€çˆ±å¥½ã€å–œæ¬¢çš„éŸ³ä¹ã€è¿åŠ¨ç­‰ã€‚å¦‚æœæˆ‘è¯´é”™äº†ï¼Œæ¸©æŸ”åœ°çº æ­£æˆ‘ã€‚`
        };

        // Weekly challenges data
        const challenges = [
            { week: 1, title: "Ask AI to introduce your favorite celebrity", desc: "ç”¨è‹±æ–‡è®© AI ä»‹ç»ä¸€ä¸ªä½ å–œæ¬¢çš„æ˜æ˜Ÿ", completed: false },
            { week: 2, title: "Ask AI to write about Yinchuan (é“¶å·)", desc: "è®© AI å¸®ä½ å†™ä¸€ç¯‡å…³äºé“¶å·çš„è‹±æ–‡ä»‹ç»", completed: false },
            { week: 3, title: "Let AI be your English teacher", desc: "è®© AI å½“ä½ çš„è‹±è¯­è€å¸ˆï¼Œçº æ­£ä½ çš„è¯­æ³•", completed: false },
            { week: 4, title: "Create a video script with AI", desc: "è®© AI å¸®ä½ åšä¸€ä¸ªè®²è§£è§†é¢‘è„šæœ¬", completed: false },
            { week: 5, title: "Design an app with AI", desc: "è®© AI å¸®ä½ è®¾è®¡ä¸€ä¸ªæ‰‹æœº app çš„åŠŸèƒ½", completed: false },
            { week: 6, title: "Write a letter to your future self", desc: "ç”¨è‹±æ–‡è®© AI å¸®ä½ å†™ä¸€å°ä¿¡ç»™æœªæ¥çš„è‡ªå·±", completed: false },
            { week: 7, title: "Create a short story with AI", desc: "å’Œ AI ä¸€èµ·ç”¨è‹±æ–‡åˆ›ä½œä¸€ä¸ªå°æ•…äº‹", completed: false },
            { week: 8, title: "Have a debate with AI", desc: "é€‰ä¸€ä¸ªè¯é¢˜ï¼Œç”¨è‹±æ–‡å’Œ AI è¿›è¡Œè¾©è®º", completed: false },
        ];

        // Current week (you can adjust this)
        const currentWeek = 1;

        // Review state
        let reviewWords = [];
        let currentReviewIndex = 0;

        // Tab switching
        function showTab(tab) {
            ['main', 'english', 'homework', 'review'].forEach(t => {
                document.getElementById('content-' + t).classList.add('hidden');
                document.getElementById('tab-' + t).classList.remove('tab-active');
                document.getElementById('tab-' + t).classList.add('text-white');
            });
            document.getElementById('content-' + tab).classList.remove('hidden');
            document.getElementById('tab-' + tab).classList.add('tab-active');
            document.getElementById('tab-' + tab).classList.remove('text-white');
            
            if (tab === 'homework') renderHomework();
            if (tab === 'review') filterReview();
            if (tab === 'english') {
                renderVocab();
                renderSummaries();
            }
        }

        // Settings
        function openSettings() {
            document.getElementById('serverChanKey').value = serverChanKey;
            document.getElementById('settingsModal').classList.remove('hidden');
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.add('hidden');
        }

        function saveSettings() {
            serverChanKey = document.getElementById('serverChanKey').value.trim();
            localStorage.setItem('weijia_serverchan', serverChanKey);
            closeSettings();
            alert('Settings saved! è®¾ç½®å·²ä¿å­˜ï¼');
        }

        // Send WeChat notification via Serveré…±
        async function sendNotification(title, content) {
            if (!serverChanKey) return;
            try {
                const url = `https://sctapi.ftqq.com/${serverChanKey}.send`;
                await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: `title=${encodeURIComponent(title)}&desp=${encodeURIComponent(content)}`,
                    mode: 'no-cors'
                });
                console.log('Notification sent:', title);
            } catch (e) {
                console.error('Failed to send notification:', e);
            }
        }

        // Load saved data
        function loadData() {
            const savedChallenges = localStorage.getItem('weijia_challenges');
            if (savedChallenges) {
                const parsed = JSON.parse(savedChallenges);
                parsed.forEach((saved, i) => {
                    if (challenges[i]) challenges[i].completed = saved.completed;
                });
            }
            updateStats();
            renderChallenges();
            loadQuestionHistory();
        }

        // Render challenges
        function renderChallenges() {
            const container = document.getElementById('challengeList');
            container.innerHTML = challenges.map((c, i) => `
                <div class="flex items-center p-4 rounded-xl transition-all duration-200 ${c.week === currentWeek ? 'current-week bg-amber-50' : 'bg-gray-50 hover:bg-gray-100'}" 
                     onclick="toggleChallenge(${i})">
                    <div class="w-10 h-10 rounded-full ${c.completed ? 'bg-green-400' : 'bg-gray-200'} flex items-center justify-center mr-4 transition-all duration-300 text-white font-bold">
                        ${c.completed ? 'âœ“' : c.week}
                    </div>
                    <div class="flex-1">
                        <div class="font-bold ${c.completed ? 'text-green-600 line-through' : 'text-gray-700'}">
                            Week ${c.week}: ${c.title}
                        </div>
                        <div class="text-sm text-gray-500">${c.desc}</div>
                    </div>
                    ${c.week === currentWeek ? '<span class="bg-amber-400 text-white text-xs px-2 py-1 rounded-full ml-2">This Week</span>' : ''}
                </div>
            `).join('');
        }

        // Toggle challenge completion
        function toggleChallenge(index) {
            const wasCompleted = challenges[index].completed;
            challenges[index].completed = !wasCompleted;
            localStorage.setItem('weijia_challenges', JSON.stringify(challenges));
            updateStats();
            renderChallenges();
            
            if (!wasCompleted && challenges[index].completed) {
                sendNotification(
                    'ğŸ‰ Weijia completed a challenge!',
                    `âœ… Week ${challenges[index].week}: ${challenges[index].title}\n\n${challenges[index].desc}`
                );
            }
        }

        // Update stats
        function updateStats() {
            const completed = challenges.filter(c => c.completed).length;
            document.getElementById('challenges').textContent = completed;
            
            const homework = JSON.parse(localStorage.getItem('weijia_homework') || '[]');
            const completedHW = homework.filter(h => h.completed).length;
            document.getElementById('homeworkCount').textContent = completedHW;
            
            const streak = localStorage.getItem('weijia_streak') || '0';
            document.getElementById('streak').textContent = streak;

            const vocab = JSON.parse(localStorage.getItem('weijia_vocab') || '[]');
            document.getElementById('vocabCount').textContent = vocab.length;

            // Update review count
            const needReview = vocab.filter(v => needsReview(v)).length;
            const reviewCountEl = document.getElementById('reviewCount');
            if (reviewCountEl) reviewCountEl.textContent = needReview;
        }

        // Check if word needs review (simple spaced repetition)
        function needsReview(vocab) {
            if (!vocab.lastReview) return true;
            const daysSince = (Date.now() - vocab.lastReview) / (1000 * 60 * 60 * 24);
            const interval = vocab.interval || 1;
            return daysSince >= interval;
        }

        // Save question
        function saveQuestion() {
            const textarea = document.getElementById('dailyQuestion');
            const question = textarea.value.trim();
            if (!question) return alert('Please write your question first!');
            
            const questions = JSON.parse(localStorage.getItem('weijia_questions') || '[]');
            questions.unshift({
                text: question,
                date: new Date().toLocaleDateString('zh-CN')
            });
            localStorage.setItem('weijia_questions', JSON.stringify(questions));
            
            let streak = parseInt(localStorage.getItem('weijia_streak') || '0');
            const lastDate = localStorage.getItem('weijia_last_date');
            const today = new Date().toDateString();
            if (lastDate !== today) {
                streak++;
                localStorage.setItem('weijia_streak', streak);
                localStorage.setItem('weijia_last_date', today);
            }
            
            textarea.value = '';
            updateStats();
            loadQuestionHistory();
            
            sendNotification('ğŸ’¡ Weijia asked a question!', `â“ ${question}`);
            alert('Question saved! ğŸŒŸ');
        }

        // Load question history
        function loadQuestionHistory() {
            const questions = JSON.parse(localStorage.getItem('weijia_questions') || '[]');
            const container = document.getElementById('questionHistory');
            if (questions.length === 0) {
                container.innerHTML = '';
                return;
            }
            container.innerHTML = `
                <p class="text-sm text-gray-500 mt-4 mb-2">ğŸ“œ Recent Questions:</p>
                ${questions.slice(0, 5).map(q => `
                    <div class="bg-purple-50 rounded-lg p-3 text-sm">
                        <span class="text-purple-600">${q.text}</span>
                        <span class="text-gray-400 text-xs ml-2">${q.date}</span>
                    </div>
                `).join('')}
            `;
        }

        // Save teach back
        function saveTeachBack() {
            const textarea = document.getElementById('teachBack');
            const content = textarea.value.trim();
            if (!content) return alert('Please write what you learned first!');
            
            const entries = JSON.parse(localStorage.getItem('weijia_teachback') || '[]');
            entries.unshift({
                text: content,
                date: new Date().toLocaleDateString('zh-CN')
            });
            localStorage.setItem('weijia_teachback', JSON.stringify(entries));
            
            textarea.value = '';
            sendNotification('ğŸ‘©â€ğŸ« Weijia became a mini teacher!', `ğŸ“ ${content}`);
            alert('Notes saved! ğŸ‘©â€ğŸ«');
        }

        // ============ VOCABULARY FUNCTIONS ============
        function addVocab() {
            const word = document.getElementById('newWord').value.trim();
            const meaning = document.getElementById('wordMeaning').value.trim();
            const example = document.getElementById('wordExample').value.trim();

            if (!word || !meaning) {
                return alert('Please enter both word and meaning! è¯·å¡«å†™å•è¯å’Œæ„æ€ï¼');
            }

            const vocab = JSON.parse(localStorage.getItem('weijia_vocab') || '[]');
            vocab.unshift({
                id: Date.now(),
                word,
                meaning,
                example,
                createdAt: Date.now(),
                lastReview: null,
                interval: 1,
                correctCount: 0
            });
            localStorage.setItem('weijia_vocab', JSON.stringify(vocab));

            document.getElementById('newWord').value = '';
            document.getElementById('wordMeaning').value = '';
            document.getElementById('wordExample').value = '';

            renderVocab();
            updateStats();
            alert('Word added! å•è¯å·²æ·»åŠ ï¼');
        }

        function renderVocab() {
            const vocab = JSON.parse(localStorage.getItem('weijia_vocab') || '[]');
            const container = document.getElementById('vocabList');

            if (vocab.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-4">No words yet. Add your first word! ğŸ“–</p>';
                return;
            }

            container.innerHTML = vocab.slice(0, 20).map(v => `
                <div class="vocab-card bg-gray-50 rounded-xl p-4">
                    <div class="flex justify-between items-start">
                        <div>
                            <span class="font-bold text-green-700 text-lg">${v.word}</span>
                            <span class="text-gray-500 ml-2">${v.meaning}</span>
                        </div>
                        <button onclick="deleteVocab(${v.id})" class="text-red-400 hover:text-red-600 text-sm">ğŸ—‘ï¸</button>
                    </div>
                    ${v.example ? `<p class="text-gray-400 text-sm mt-1 italic">"${v.example}"</p>` : ''}
                    <div class="text-xs text-gray-400 mt-2">
                        Added: ${new Date(v.createdAt).toLocaleDateString('zh-CN')}
                        ${v.lastReview ? ` | Last review: ${new Date(v.lastReview).toLocaleDateString('zh-CN')}` : ''}
                    </div>
                </div>
            `).join('');

            if (vocab.length > 20) {
                container.innerHTML += `<p class="text-gray-400 text-center text-sm">And ${vocab.length - 20} more words...</p>`;
            }
        }

        function deleteVocab(id) {
            if (!confirm('Delete this word? åˆ é™¤è¿™ä¸ªå•è¯ï¼Ÿ')) return;
            let vocab = JSON.parse(localStorage.getItem('weijia_vocab') || '[]');
            vocab = vocab.filter(v => v.id !== id);
            localStorage.setItem('weijia_vocab', JSON.stringify(vocab));
            renderVocab();
            updateStats();
        }

        function copyVocabPrompt() {
            const vocab = JSON.parse(localStorage.getItem('weijia_vocab') || '[]');
            const recentWords = vocab.slice(0, 10).map(v => v.word).join(', ');
            
            const prompt = `Please create example sentences for these English words. For each word:
1. Give a simple, natural sentence
2. Highlight the word in the sentence
3. Add Chinese translation

Words: ${recentWords || 'apple, book, happy'}

è¯·ä¸ºè¿™äº›è‹±è¯­å•è¯é€ ä¾‹å¥ã€‚æ¯ä¸ªå•è¯ï¼š
1. ç»™å‡ºç®€å•è‡ªç„¶çš„å¥å­
2. åœ¨å¥å­ä¸­çªå‡ºè¿™ä¸ªå•è¯
3. åŠ ä¸Šä¸­æ–‡ç¿»è¯‘`;

            navigator.clipboard.writeText(prompt).then(() => {
                alert('Prompt copied! Now paste it to AI æç¤ºè¯å·²å¤åˆ¶ï¼å»ç²˜è´´ç»™ AI');
            });
        }

        function startVocabReview() {
            const vocab = JSON.parse(localStorage.getItem('weijia_vocab') || '[]');
            reviewWords = vocab.filter(v => needsReview(v));
            
            if (reviewWords.length === 0) {
                alert('No words to review right now! ç°åœ¨æ²¡æœ‰éœ€è¦å¤ä¹ çš„å•è¯ï¼');
                return;
            }

            currentReviewIndex = 0;
            document.getElementById('vocabReviewModal').classList.remove('hidden');
            showReviewWord();
        }

        function showReviewWord() {
            if (currentReviewIndex >= reviewWords.length) {
                alert('Review complete! Great job! å¤ä¹ å®Œæˆï¼åšå¾—å¥½ï¼');
                closeVocabReview();
                return;
            }

            const word = reviewWords[currentReviewIndex];
            document.getElementById('reviewWord').textContent = word.word;
            document.getElementById('reviewMeaning').textContent = word.meaning;
            document.getElementById('reviewMeaning').classList.add('hidden');
            document.getElementById('reviewExample').textContent = word.example || '';
            document.getElementById('reviewExample').classList.add('hidden');
            document.getElementById('showMeaningBtn').classList.remove('hidden');
            document.getElementById('reviewProgress').textContent = `${currentReviewIndex + 1}/${reviewWords.length}`;
        }

        function showMeaning() {
            document.getElementById('reviewMeaning').classList.remove('hidden');
            document.getElementById('reviewExample').classList.remove('hidden');
            document.getElementById('showMeaningBtn').classList.add('hidden');
        }

        function nextReviewWord(correct) {
            const word = reviewWords[currentReviewIndex];
            let vocab = JSON.parse(localStorage.getItem('weijia_vocab') || '[]');
            const idx = vocab.findIndex(v => v.id === word.id);
            
            if (idx !== -1) {
                vocab[idx].lastReview = Date.now();
                if (correct) {
                    vocab[idx].correctCount = (vocab[idx].correctCount || 0) + 1;
                    vocab[idx].interval = Math.min((vocab[idx].interval || 1) * 2, 30);
                } else {
                    vocab[idx].interval = 1;
                }
                localStorage.setItem('weijia_vocab', JSON.stringify(vocab));
            }

            currentReviewIndex++;
            showReviewWord();
            updateStats();
        }

        function closeVocabReview() {
            document.getElementById('vocabReviewModal').classList.add('hidden');
        }

        // ============ SCENARIO FUNCTIONS ============
        function loadScenario(type) {
            const prompt = scenarios[type];
            document.getElementById('scenarioText').textContent = prompt;
            document.getElementById('scenarioPrompt').classList.remove('hidden');
        }

        function copyScenarioPrompt() {
            const text = document.getElementById('scenarioText').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('Prompt copied! æç¤ºè¯å·²å¤åˆ¶ï¼');
            });
        }

        // ============ CLASS SUMMARY FUNCTIONS ============
        function copySummaryPrompt() {
            const text = document.getElementById('summaryPromptText').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('Prompt copied! Now upload your recording to Kimi æç¤ºè¯å·²å¤åˆ¶ï¼å» Kimi ä¸Šä¼ å½•éŸ³');
            });
        }

        function saveClassSummary() {
            const summary = document.getElementById('classSummary').value.trim();
            if (!summary) {
                return alert('Please paste your summary first! è¯·å…ˆç²˜è´´æ€»ç»“å†…å®¹ï¼');
            }

            const summaries = JSON.parse(localStorage.getItem('weijia_summaries') || '[]');
            summaries.unshift({
                id: Date.now(),
                content: summary,
                date: new Date().toLocaleDateString('zh-CN')
            });
            localStorage.setItem('weijia_summaries', JSON.stringify(summaries));

            document.getElementById('classSummary').value = '';
            renderSummaries();
            
            sendNotification('ğŸ“ Weijia saved a class summary!', summary.slice(0, 200) + '...');
            alert('Summary saved! æ€»ç»“å·²ä¿å­˜ï¼');
        }

        function renderSummaries() {
            const summaries = JSON.parse(localStorage.getItem('weijia_summaries') || '[]');
            const container = document.getElementById('summaryList');

            if (summaries.length === 0) {
                container.innerHTML = '';
                return;
            }

            container.innerHTML = `
                <p class="text-gray-600 font-semibold mb-2">ğŸ“š Saved Summaries / å·²ä¿å­˜çš„æ€»ç»“</p>
                ${summaries.slice(0, 5).map(s => `
                    <div class="bg-blue-50 rounded-xl p-4 border border-blue-100">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-blue-600 font-semibold">${s.date}</span>
                            <button onclick="deleteSummary(${s.id})" class="text-red-400 hover:text-red-600 text-sm">ğŸ—‘ï¸</button>
                        </div>
                        <p class="text-gray-600 text-sm whitespace-pre-line">${s.content.slice(0, 300)}${s.content.length > 300 ? '...' : ''}</p>
                    </div>
                `).join('')}
            `;
        }

        function deleteSummary(id) {
            if (!confirm('Delete this summary? åˆ é™¤è¿™ä¸ªæ€»ç»“ï¼Ÿ')) return;
            let summaries = JSON.parse(localStorage.getItem('weijia_summaries') || '[]');
            summaries = summaries.filter(s => s.id !== id);
            localStorage.setItem('weijia_summaries', JSON.stringify(summaries));
            renderSummaries();
        }

        // ============ HOMEWORK FUNCTIONS ============
        function addHomework() {
            const subject = document.getElementById('hwSubject').value;
            const content = document.getElementById('hwContent').value.trim();
            const dueDate = document.getElementById('hwDueDate').value;
            
            if (!content) return alert('Please fill in the homework content!');
            
            const homework = JSON.parse(localStorage.getItem('weijia_homework') || '[]');
            homework.unshift({
                id: Date.now(),
                subject,
                content,
                dueDate,
                completed: false,
                createdAt: new Date().toISOString()
            });
            localStorage.setItem('weijia_homework', JSON.stringify(homework));
            
            document.getElementById('hwContent').value = '';
            document.getElementById('hwDueDate').value = '';
            
            renderHomework();
            updateStats();
            alert('Homework added!');
        }

        function renderHomework() {
            const homework = JSON.parse(localStorage.getItem('weijia_homework') || '[]');
            const pending = homework.filter(h => !h.completed);
            const container = document.getElementById('pendingHomework');
            
            if (pending.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-8">No pending homework âœ¨</p>';
                return;
            }
            
            container.innerHTML = pending.map(h => `
                <div class="homework-card bg-gray-50 rounded-xl p-4">
                    <div class="flex justify-between items-start mb-2">
                        <span class="font-bold text-purple-600">${h.subject}</span>
                        ${h.dueDate ? `<span class="text-sm text-gray-400">Due: ${h.dueDate}</span>` : ''}
                    </div>
                    <p class="text-gray-700 mb-3">${h.content}</p>
                    <button onclick="completeHomework(${h.id})" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all">
                        âœ… Done
                    </button>
                    <button onclick="deleteHomework(${h.id})" class="bg-red-400 hover:bg-red-500 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all ml-2">
                        ğŸ—‘ï¸ Delete
                    </button>
                </div>
            `).join('');
        }

        function completeHomework(id) {
            const homework = JSON.parse(localStorage.getItem('weijia_homework') || '[]');
            const hw = homework.find(h => h.id === id);
            if (hw) {
                hw.completed = true;
                hw.completedAt = new Date().toISOString();
                localStorage.setItem('weijia_homework', JSON.stringify(homework));
                sendNotification('âœ… Weijia finished homework!', `ğŸ“š ${hw.subject}\nğŸ“ ${hw.content}`);
            }
            renderHomework();
            updateStats();
            alert('Homework done! ğŸ‰');
        }

        function deleteHomework(id) {
            if (!confirm('Delete this homework?')) return;
            let homework = JSON.parse(localStorage.getItem('weijia_homework') || '[]');
            homework = homework.filter(h => h.id !== id);
            localStorage.setItem('weijia_homework', JSON.stringify(homework));
            renderHomework();
            updateStats();
        }

        function deleteHomeworkFromReview(id) {
            if (!confirm('Delete this homework?')) return;
            let homework = JSON.parse(localStorage.getItem('weijia_homework') || '[]');
            homework = homework.filter(h => h.id !== id);
            localStorage.setItem('weijia_homework', JSON.stringify(homework));
            filterReview();
            updateStats();
        }

        function filterReview() {
            const subject = document.getElementById('reviewSubject').value;
            const homework = JSON.parse(localStorage.getItem('weijia_homework') || '[]');
            const completed = homework.filter(h => h.completed && (subject === 'all' || h.subject === subject));
            const container = document.getElementById('reviewList');
            
            if (completed.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-8">No completed homework for this subject ğŸ“</p>';
                return;
            }
            
            container.innerHTML = completed.map(h => `
                <div class="bg-gray-50 rounded-xl p-4 border-l-4 border-green-400">
                    <div class="flex justify-between items-start mb-2">
                        <span class="font-bold text-green-600">${h.subject}</span>
                        <span class="text-sm text-gray-400">${new Date(h.completedAt).toLocaleDateString('zh-CN')}</span>
                    </div>
                    <p class="text-gray-700 mb-3">${h.content}</p>
                    <button onclick="deleteHomeworkFromReview(${h.id})" class="bg-red-400 hover:bg-red-500 text-white font-bold py-2 px-4 rounded-lg text-sm transition-all">
                        ğŸ—‘ï¸ Delete
                    </button>
                </div>
            `).join('');
        }

        // Initialize
        loadData();
    </script>
</body>
</html>
